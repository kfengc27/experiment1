{"ast":null,"code":"import { useState, useRef, useCallback } from 'react';\nimport { HoverActionTypes } from '../utils/constants.js';\nimport { indexOfNode } from '../utils/utils.js';\n\nvar useItems = function useItems(menuRef, focusRef) {\n  var _useState = useState(),\n      hoverItem = _useState[0],\n      setHoverItem = _useState[1];\n\n  var stateRef = useRef({\n    items: [],\n    hoverIndex: -1,\n    sorted: false\n  });\n  var mutableState = stateRef.current;\n  var updateItems = useCallback(function (item, isMounted) {\n    var items = mutableState.items;\n\n    if (!item) {\n      mutableState.items = [];\n    } else if (isMounted) {\n      items.push(item);\n    } else {\n      var index = items.indexOf(item);\n\n      if (index > -1) {\n        items.splice(index, 1);\n\n        if (item.contains(document.activeElement)) {\n          focusRef.current.focus();\n          setHoverItem();\n        }\n      }\n    }\n\n    mutableState.hoverIndex = -1;\n    mutableState.sorted = false;\n  }, [mutableState, focusRef]);\n  var dispatch = useCallback(function (actionType, item, nextIndex) {\n    var items = mutableState.items,\n        hoverIndex = mutableState.hoverIndex;\n\n    var sortItems = function sortItems() {\n      if (mutableState.sorted) return;\n      var orderedNodes = menuRef.current.querySelectorAll('.szh-menu__item');\n      items.sort(function (a, b) {\n        return indexOfNode(orderedNodes, a) - indexOfNode(orderedNodes, b);\n      });\n      mutableState.sorted = true;\n    };\n\n    var index = -1,\n        newItem = undefined;\n\n    switch (actionType) {\n      case HoverActionTypes.RESET:\n        break;\n\n      case HoverActionTypes.SET:\n        newItem = item;\n        break;\n\n      case HoverActionTypes.UNSET:\n        newItem = function newItem(prevItem) {\n          return prevItem === item ? undefined : prevItem;\n        };\n\n        break;\n\n      case HoverActionTypes.FIRST:\n        sortItems();\n        index = 0;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.LAST:\n        sortItems();\n        index = items.length - 1;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.SET_INDEX:\n        sortItems();\n        index = nextIndex;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.INCREASE:\n        sortItems();\n        index = hoverIndex;\n        if (index < 0) index = items.indexOf(item);\n        index++;\n        if (index >= items.length) index = 0;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.DECREASE:\n        sortItems();\n        index = hoverIndex;\n        if (index < 0) index = items.indexOf(item);\n        index--;\n        if (index < 0) index = items.length - 1;\n        newItem = items[index];\n        break;\n\n      default:\n        if (process.env.NODE_ENV !== 'production') throw new Error(\"[React-Menu] Unknown hover action type: \" + actionType);\n    }\n\n    if (!newItem) index = -1;\n    setHoverItem(newItem);\n    mutableState.hoverIndex = index;\n  }, [menuRef, mutableState]);\n  return {\n    hoverItem: hoverItem,\n    dispatch: dispatch,\n    updateItems: updateItems\n  };\n};\n\nexport { useItems };","map":{"version":3,"names":["useState","useRef","useCallback","HoverActionTypes","indexOfNode","useItems","menuRef","focusRef","_useState","hoverItem","setHoverItem","stateRef","items","hoverIndex","sorted","mutableState","current","updateItems","item","isMounted","push","index","indexOf","splice","contains","document","activeElement","focus","dispatch","actionType","nextIndex","sortItems","orderedNodes","querySelectorAll","sort","a","b","newItem","undefined","RESET","SET","UNSET","prevItem","FIRST","LAST","length","SET_INDEX","INCREASE","DECREASE","process","env","NODE_ENV","Error"],"sources":["/Users/chengbinfeng/Developer/experiment1/node_modules/@szhsin/react-menu/dist/es/hooks/useItems.js"],"sourcesContent":["import { useState, useRef, useCallback } from 'react';\nimport { HoverActionTypes } from '../utils/constants.js';\nimport { indexOfNode } from '../utils/utils.js';\n\nvar useItems = function useItems(menuRef, focusRef) {\n  var _useState = useState(),\n      hoverItem = _useState[0],\n      setHoverItem = _useState[1];\n\n  var stateRef = useRef({\n    items: [],\n    hoverIndex: -1,\n    sorted: false\n  });\n  var mutableState = stateRef.current;\n  var updateItems = useCallback(function (item, isMounted) {\n    var items = mutableState.items;\n\n    if (!item) {\n      mutableState.items = [];\n    } else if (isMounted) {\n      items.push(item);\n    } else {\n      var index = items.indexOf(item);\n\n      if (index > -1) {\n        items.splice(index, 1);\n\n        if (item.contains(document.activeElement)) {\n          focusRef.current.focus();\n          setHoverItem();\n        }\n      }\n    }\n\n    mutableState.hoverIndex = -1;\n    mutableState.sorted = false;\n  }, [mutableState, focusRef]);\n  var dispatch = useCallback(function (actionType, item, nextIndex) {\n    var items = mutableState.items,\n        hoverIndex = mutableState.hoverIndex;\n\n    var sortItems = function sortItems() {\n      if (mutableState.sorted) return;\n      var orderedNodes = menuRef.current.querySelectorAll('.szh-menu__item');\n      items.sort(function (a, b) {\n        return indexOfNode(orderedNodes, a) - indexOfNode(orderedNodes, b);\n      });\n      mutableState.sorted = true;\n    };\n\n    var index = -1,\n        newItem = undefined;\n\n    switch (actionType) {\n      case HoverActionTypes.RESET:\n        break;\n\n      case HoverActionTypes.SET:\n        newItem = item;\n        break;\n\n      case HoverActionTypes.UNSET:\n        newItem = function newItem(prevItem) {\n          return prevItem === item ? undefined : prevItem;\n        };\n\n        break;\n\n      case HoverActionTypes.FIRST:\n        sortItems();\n        index = 0;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.LAST:\n        sortItems();\n        index = items.length - 1;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.SET_INDEX:\n        sortItems();\n        index = nextIndex;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.INCREASE:\n        sortItems();\n        index = hoverIndex;\n        if (index < 0) index = items.indexOf(item);\n        index++;\n        if (index >= items.length) index = 0;\n        newItem = items[index];\n        break;\n\n      case HoverActionTypes.DECREASE:\n        sortItems();\n        index = hoverIndex;\n        if (index < 0) index = items.indexOf(item);\n        index--;\n        if (index < 0) index = items.length - 1;\n        newItem = items[index];\n        break;\n\n      default:\n        if (process.env.NODE_ENV !== 'production') throw new Error(\"[React-Menu] Unknown hover action type: \" + actionType);\n    }\n\n    if (!newItem) index = -1;\n    setHoverItem(newItem);\n    mutableState.hoverIndex = index;\n  }, [menuRef, mutableState]);\n  return {\n    hoverItem: hoverItem,\n    dispatch: dispatch,\n    updateItems: updateItems\n  };\n};\n\nexport { useItems };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}